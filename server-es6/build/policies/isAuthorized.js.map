{"version":3,"sources":["../../server/policies/isAuthorized.js"],"names":[],"mappings":";;AAAA,IAAI,YAAY,QAAS,sBAAT,CAAZ;;AAEJ,OAAO,OAAP,GAAiB,UAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;AACzC,MAAI,KAAJ,CADyC;;AAGzC,MAAI,IAAI,OAAJ,IAAe,IAAI,OAAJ,CAAY,aAAZ,EAA2B;;AAE5C,QAAI,QAAQ,IAAI,OAAJ,CAAY,aAAZ,CAA0B,KAA1B,CAAgC,GAAhC,CAAR,CAFwC;;AAI5C,QAAI,MAAM,MAAN,IAAgB,CAAhB,EAAmB;AACrB,UAAI,SAAS,MAAM,CAAN,CAAT,CADiB;AAErB,UAAI,cAAc,MAAM,CAAN,CAAd,CAFiB;;AAIrB,UAAI,YAAY,IAAZ,CAAiB,MAAjB,CAAJ,EAA8B;AAC5B,gBAAQ,WAAR,CAD4B;OAA9B;KAJF,MAQO;AACL,aAAO,IAAI,IAAJ,CAAS,EAAC,KAAK,yCAAL,EAAV,CAAP,CADK;KARP;GAJF,MAgBO,IAAG,IAAI,KAAJ,CAAU,UAAV,EAAsB;AAC9B,YAAQ,IAAI,KAAJ,CAAU,UAAV,CADsB;GAAzB,MAEA;AACL,WAAO,IAAI,IAAJ,CAAS,EAAC,KAAK,mCAAL,EAAV,CAAP,CADK;GAFA;;AAMP,YAAU,MAAV,CAAiB,KAAjB,EAAwB,UAAU,GAAV,EAAe,KAAf,EAAsB;AAC5C,QAAI,GAAJ,EAAS,OAAO,IAAI,IAAJ,CAAS,EAAC,KAAK,gBAAL,EAAV,CAAP,CAAT;AACA,QAAI,KAAJ,GAAY,KAAZ,CAF4C;AAG5C,WAH4C;GAAtB,CAAxB,CAzByC;CAA1B","file":"isAuthorized.js","sourcesContent":["var tokenAuth = require ('./../utils/tokenAuth');\n\nmodule.exports = function (req, res, next) {\n  var token;\n\n  if (req.headers && req.headers.authorization) {\n\n    var parts = req.headers.authorization.split(' ');\n\n    if (parts.length == 2) {\n      var scheme = parts[0];\n      var credentials = parts[1];\n\n      if (/^Bearer$/i.test(scheme)) {\n        token = credentials;\n      }\n\n    } else {\n      return res.json({err: 'Format is Authorization: Bearer [token]'});\n    }\n\n  } else if(req.query.auth_token) {\n    token = req.query.auth_token\n  } else {\n    return res.json({err: 'No Authorization header was found'});\n  }\n\n  tokenAuth.verify(token, function (err, token) {\n    if (err) return res.json({err: 'Invalid Token!'});\n    req.token = token; \n    next();\n  });\n};"]}