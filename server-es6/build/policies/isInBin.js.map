{"version":3,"sources":["../../server/policies/isInBin.js"],"names":[],"mappings":";;;;;;;;AACA,IAAI,OAAO,iBAAO,IAAP;AACX,IAAI,SAAS,iBAAO,MAAP;;AAEb,IAAI,MAAM,QAAQ,kBAAR,CAAN;;AAEJ,OAAO,OAAP,GAAiB,UAAS,GAAT,EAAc,GAAd,EAAmB,IAAnB,EAAyB;;AAExC,MAAI,gBAAgB,IAAI,KAAJ,CAAU,EAAV,CAFoB;AAGxC,MAAI,aAAa,IAAI,IAAJ,CAAS,KAAT,IAAkB,IAAI,KAAJ,CAAU,KAAV,IAAmB,IAAI,MAAJ,CAAW,KAAX,CAHd;;AAKxC,MAAI,GAAJ,CAAQ,UAAR,EAAoB,OAApB,CAA4B,EAAC,OAAO,IAAP,EAA7B,EAA2C,GAA3C,GAAiD,IAAjD,CAAsD,UAAS,GAAT,EAAa;AACjE,QAAM,QAAQ,IAAI,KAAJ,CADmD;AAEjE,SAAI,IAAI,IAAI,CAAJ,EAAO,IAAI,MAAM,MAAN,EAAc,GAAjC,EAAsC;AAClC,UAAI,MAAM,CAAN,EAAS,EAAT,IAAe,aAAf,EAA8B;AAC9B,eAD8B;AAE9B,eAAO,GAAP,CAF8B;OAAlC;KADJ;AAMA,WAAO,IAAI,IAAJ,CAAS,EAAC,OAAO,0BAAP,EAAV,CAAP,CARiE;GAAb,CAAtD,CASG,KATH,CASS,OAAO,gBAAP,EAAyB,UAAS,GAAT,EAAc;AAC9C,WAAO,IAAI,IAAJ,CAAS,EAAC,OAAO,gBAAP,EAAV,CAAP,CAD8C;GAAd,CATlC,CALwC;CAAzB","file":"isInBin.js","sourcesContent":["import thinky from'./../utils/thinky.js'\nvar type = thinky.type\nvar Errors = thinky.Errors\n\nvar Bin = require('./../models/bins')\n\nmodule.exports = function(req, res, next) {\n\n  var currentUserId = req.token.id\n  var currentBin = req.body.binId || req.query.binId || req.params.binId\n\n  Bin.get(currentBin).getJoin({users: true}).run().then(function(bin){\n    const users = bin.users \n    for(var i = 0; i < users.length; i++) {\n        if (users[i].id == currentUserId) {\n            next()\n            return ' '\n        }\n    }\n    return res.json({\"err\": \"User is not in that Bin.\"})\n  }).catch(Errors.DocumentNotFound, function(err) {\n    return res.json({\"err\": \"Bin not found.\"})\n  })\n\n};"]}